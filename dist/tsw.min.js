/*! Theresa's Sound World - v0.3.0 - (c) 2015 Stuart Memo */!function(a,b){"use strict";var c,d="0.3.0";c=function(){var b=function(a,b){for(var c in b)a[c]=b[c];return a},c=function(a,b){for(var c in b)a[c].value=b[c]},e=function(a){return Array.isArray(a)},f=function(a){return"function"==typeof a},g=function(a){return"object"==typeof a},h=function(a){return"string"==typeof a},i=function(a){return"number"==typeof a},j=function(a){return"undefined"!=typeof a},k=function(a){j(a);return j(a)&&null!==a?!0:void 0},l=function(a){var b=!1;return Object(a)&&"node"in a&&(b=!0),b},m=function(a){return"undefined"!=typeof a.context},n=function(a){return a.hasOwnProperty("input")||a.hasOwnProperty("output")},o=function(a){return g(a)?"setValueAtTime"in a:!1},p=function(a,b,c,d,e){if(k(e))switch(e){case"linear":a[b].setValueAtTime(a[b].value,t.now()),a[b].linearRampToValueAtTime(c,d);break;case"exponential":a[b].setValueAtTime(a[b].value,t.now()),0===c&&(c=1e-8),a[b].exponentialRampToValueAtTime(c,d);break;default:a[b].setValueAtTime(c,d)}else a[b].setValueAtTime(c,d)},q=function(a,b){return a&&k(a[b])?k(a[b].value)?a[b].value:a[b]:void 0},r=function(a,b,c,d,e){k(a[b].value)?k(d)?p(a,b,c,d,e):a[b].value=c:a[b]=c},s=function(a,b){return function(c,d,e){return k(c)?r(a,b,c,d,e):q(a,b)}},t={},u=[];t.version=d,t.isBrowserSupported=!1,t.processors=[];var v=function(a,b){var c;if("undefined"==typeof webkitAudioContext&&"undefined"==typeof AudioContext)if("undefined"==typeof webkitAudiocontext().prototype.createGainNode)b("Sorry, your browser doesn't support a recent enough version of the Web Audio API.");else{var d=webkitAudiocontext().prototype;d.createGain=d.createGainNode,d.createDelay=d.createDelayNode,d.createScriptProcessor=d.createJavaScriptNode}else"function"==typeof AudioContext?(c=new AudioContext,t.context=function(){return c}):(c=new webkitAudioContext,t.context=function(){return c});t.isBrowserSupported=!0,a()},w=function(){t.speakers=t.context().destination,t.osc=t.oscillator};t.now=function(){return this.context().currentTime},t.channelSplitter=function(){return t.context().createChannelSplitter()},t.channelMerger=function(a){return t.context().createChannelMerger(a)},t.connect=function(){var a,b=arguments.length,c=function(a,b){a.connectedTo=a.connectedTo||[],a.hasOwnProperty("connectedTo")&&a.connectedTo.push(b)},d=function(){arguments[0].connect(arguments[1],0,arguments[2]),c(arguments[0],arguments[1])},f=function(){arguments[0].connect(arguments[1].input,0,arguments[2]),c(arguments[0],arguments[1])},g=function(){for(var a=0;a<arguments[1].length;a++)t.connect(arguments[0],arguments[1][a])},h=function(){for(var a=0;a<arguments[0].length;a++)t.connect(arguments[0][a],arguments[1])},i=function(){arguments[0].output.connect(arguments[1].input,0,arguments[2]),c(arguments[0],arguments[1])},j=function(){arguments[0].output.connect(arguments[1],0,arguments[2]),c(arguments[0],arguments[1])},k=function(){for(var a=0;a<arguments[1].length;a++)t.connect(arguments[0],arguments[1][a])},p=function(){for(var a=0;a<arguments[0].length;a++)t.connect(arguments[0][a],arguments[1])},q=function(){for(var a=0;a<arguments[0].length;a++)t.connect(arguments[0][a],arguments[1])},r=function(){arguments[0].connect(arguments[1])},s=function(){arguments[0].output.connect(arguments[1])};for(a=0;b-1>a;a++){var u=arguments[a],v=arguments[a+1];if(m(u)&&n(v))f(u,v);else if(n(u)&&m(v))j(u,v);else if(m(u)&&e(v))g(u,v);else if(e(u)&&m(v))h(u,v);else if(m(u)&&m(v))d(u,v);else if(n(u)&&n(v))i(u,v);else if(n(u)&&e(v))k(u,v);else if(e(u)&&n(v))p(u,v);else if(e(u)&&e(v))q(u,v);else if(l(u)&&e(v))connectObjectWithNodeToArray(u,v);else if(e(u)&&l(v))connectArrayToObjectWithNode(u,v);else{if(l(u)&&l(v)){if(m(u.node)&&m(v.node)){d(u.node,v.node,v.channel);continue}if(n(u.node)&&m(v.node)){j(u.node,v.node,v.channel);continue}if(m(u.node)&&n(v.node)){f(u.node,v.node,v.channel);continue}if(n(u.node)&&n(v.node)){i(u.node,v.node,v.channel);continue}}m(u)&&o(v)?r(u,v):n(u)&&o(v)&&s(u,v)}}},t.disconnect=function(){var a,b=arguments.length;for(a=0;b>a;a++)arguments[a].disconnect&&(arguments[a].disconnect(),arguments[a].connectedTo=[]),n(arguments[a])&&(t.disconnect(arguments[a].output),arguments[a].connectedTo=[])},t.disconnectAfterTime=function(a,b){u.push({node:a,time:b})},t.load=function(){var a,b,c={},d=arguments[0],e="",g=[],h=0,i=0,j=0,k=this,l=function(a,b,c,d,e,g){var l=new XMLHttpRequest;l.open("GET",a+c,!0),l.responseType="arraybuffer";var m=function(){h++,k.context().decodeAudioData(l.response,function(a){d[b]=a,Object.keys(d).length===j&&e(d)})},n=function(){i++,f(g)?g():console.log("There was an error loading your file(s)",l.status)};l.onreadystatechange=function(){4===l.readyState&&(200===l.status?m():n())},l.send()};if("object"==typeof arguments[1]?(e=arguments[1].path||"",g=arguments[1].extensions||[]):"function"==typeof arguments[1]&&(a=arguments[1]),"function"==typeof arguments[2]&&(b=arguments[2]),"object"==typeof d){j=Object.keys(d).length;for(var m in d)l(e,m,d[m],c,a,b)}else{if("string"!=typeof d)throw new Error("Files must be an array or a valid string.");j=1}},t.wait=function(a){var b,c=this.context().createDelay();return b=t.createNode(),b.nodeType="wait",b.time=s(c,"delayTime"),b.time(a||1),t.connect(b.input,c,b.output),b},t.createMonoMaker=function(){var a={};return a.input=t.createGain(),a.output=t.createGain(),t.connect(a.input,a.output),a},t.panner=function(a){var b,c=(t.gain(),t.gain(0)),d=t.gain(0),e=t.channelMerger(2);b=t.createNode(),b.nodeType="panner";var f=function(a){return a>1?a=1:-1>a&&(a=-1),a};return b.pan=function(a,b){var e;return j(a)?(a=f(a||0),e=1-(a+1)/2,c.gain(e,b),d.gain(1-e,b),void 0):-(2*(c.gain()-1))-1},b.pan(a||0),t.connect(b.input,[c,d]),t.connect({node:c},{node:e,channel:0}),t.connect({node:d},{node:e,channel:1}),t.connect(e,b.output),b},t.play=function(a,b){b=b||0,e(a)?a.forEach(function(a){a.start(b)}):a.start(b)},t.stop=function(a,b){b=b||0,a.stop(b)},t.reverse=function(a){for(var b=0;b<a.buffer.numberOfChannels;b++)Array.prototype.reverse.call(a.buffer.getChannelData(b));return a};var x=function(a){this.start=function(b){return"undefined"==typeof a.sourceNode.start?a.sourceNode.noteOn(b||t.now()):a.sourceNode.start(b||t.now()),this},this.stop=function(b){return"undefined"==typeof a.sourceNode.stop?a.sourceNode.noteOff(b||t.now()):a.sourceNode.stop(b||t.now()),this}};return t.createNode=function(a){var b={};return a=a||{},b.input=t.context().createGain(),b.output=t.context().createGain(),Object.keys(a).forEach(function(c){b[c]=a[c]}),b.connectedTo=[],a.hasOwnProperty("sourceNode")?x.call(b,a):a.sourceNode=!1,b},t.oscillator=function(a,b){var c,d=t.context().createOscillator();return c=t.createNode({sourceNode:d,nodeType:"oscillator"}),c.frequency=s(d,"frequency"),c.type=s(d,"type"),c.detune=s(d,"detune"),c.params={frequency:d.frequency},c.frequency(a||440),c.type((b||"sine").toLowerCase()),c.isPlaying=function(){return 2===d.playbackState?!0:!1},this.connect(d,c.output),c},t.gain=function(a,b){var c,d;return d="function"==typeof this.context().createGain?this.context().createGain():this.context().createGainNode(),c=t.createNode({nodeType:"gain"}),c.params={gain:d.gain},c.gain=s(d,"gain"),c.gain(a,b),this.connect(c.input,d,c.output),c},t.buffer=function(a,b,c){var d;return a=a||1,b=b||65536,c=c||44100,d=this.context().createBuffer(a,b,c),d.nodeType="buffer",d},t.bufferBox=function(a){var b,c,d,e,f=t.createNode({nodeType:"bufferBox",paused:!1,stopped:!0}),g=0,h=!1;return f.buffer=function(a){return a?void(b=a):b},f.loop=function(a){return h=a,this},a&&f.buffer(a),f.play=function(a){var i=this;c=t.context().createBufferSource(),c.buffer=b,c.loop=h,this.paused=!1,this.stopped=!1,t.connect(c,f.output),c.onended=function(){i.paused||(g=0,i.stopped=!0),e&&e()},d=t.now(),c.start(t.now(),g)},f.stop=function(a){g=0,this.paused=!1,this.stopped=!0,c&&c.stop(a||t.now())},f.on=function(a,b){"end"===a&&(e=b)},f.pause=function(a){this.paused=!0,c.stop(a||t.now()),t.disconnect(c),this.stopped||(g=g+t.now()-d)},f.position=function(a){return a||0===a?void(g=a):this.paused||this.stopped?g:g+t.now()-d},f.start=f.play,f},t.decode=function(a,b,c){this.context().decodeAudioData(a,b,c)},t.filter=function(){var a=t.createNode({type:"filter"}),b={},c=t.context().createBiquadFilter();return g(arguments[0])?(b.type=arguments[0].type,b.frequency=arguments[0].frequency||1e3,b.Q=arguments[0].Q,b.gain=arguments[0].gain):h(arguments[0])&&(b.type=arguments[0]),a.nodeType="filter",a.type=s(c,"type"),a.frequency=s(c,"frequency"),a.Q=s(c,"Q"),a.gain=s(c,"gain"),a.type(b.type||"lowpass"),a.frequency(b.frequency||1e3),a.Q(b.Q||0),a.gain(b.gain||0),this.connect(a.input,c,a.output),a},t.analyser=function(){return this.context().createAnalyser()},t.compressor=function(a){var d=t.createNode({nodeType:"compressor"}),e=this.context().createDynamicsCompressor(),f={threshold:-24,knee:30,ratio:12,attack:.003,release:.25,reduction:0};return a=b(f,a),c(e,a),d.threshold=s(e,"threshold"),d.knee=s(e,"knee"),d.ratio=s(e,"ratio"),d.attack=s(e,"attack"),d.release=s(e,"release"),d.reduction=s(e,"reduction"),this.connect(d.input,e,d.output),d},t.processor=function(a,b){var c=a||1024,d=t.context().createScriptProcessor(c,1,1);return"function"==typeof b&&(d.onaudioprocess=function(a){b(a)}),d},t.waveShaper=function(){for(var a=this.context().createWaveShaper(),b=new Float32Array(65536),c=0;32768>c;c++)3e4>c?b[c]=.1:b[c]=-1;return a.curve=b,a},t.envelope=function(a){var b={};return a=a||{},b.name=a.name||"",b.nodeType="envelope",b.startLevel=a.startLevel||0,b.maxLevel=a.maxLevel||1,b.minLevel=a.minLevel||0,b.param=a.param||null,b.attackTime=a.attack||0,b.decayTime=a.decay||0,b.sustainLevel=a.sustain||1,b.releaseTime=a.release||0,o(a.param)&&(b.param=a.param),b.start=function(a){var b=this.attackTime+this.decayTime;b+this.releaseTime;this.maxLevel=this.startLevel+this.maxLevel,this.sustainLevel=this.startLevel+this.sustainLevel,o(this.param)&&(a=a||t.now(),this.param.setValueAtTime(this.startLevel,a),this.param.linearRampToValueAtTime(this.maxLevel,a+this.attackTime),this.param.setValueAtTime(this.maxLevel,a+this.attackTime),this.param.exponentialRampToValueAtTime(this.sustainLevel,a+b),this.param.setValueAtTime(this.sustainLevel,a+b))},b.release=function(a){var b=this.minLevel;a=a||t.now(),0===this.minLevel&&(b=1e-8),o(this.param)&&(this.param.setValueAtTime(this.sustainLevel,a),this.param.exponentialRampToValueAtTime(b,a+this.releaseTime),this.param.exponentialRampToValueAtTime(b,a+this.releaseTime),this.param.setValueAtTime(this.minLevel,a+this.releaseTime))},b},t.noise=function(){var a,b=this.buffer(),c=this.bufferBox(),d=b.length;for(a=0;d>a;a++)b.getChannelData(0)[a]=2*Math.random()-1;return c.nodeType="noise",c.buffer(b),c.loop(!0),c},t.lfo=function(a){var b,c=t.oscillator(a||10);return b=t.createNode({sourceNode:c,nodeType:"lfo"}),b.modulate=function(a){k(a)&&(t.connect(c,a),c.start())},b.frequency=c.frequency,b},t.getUserAudio=function(a,b){var c=function(b){var c=t.context().createMediaStreamSource(b);a(c)};navigator.webkitGetUserMedia({audio:!0},c,b)},t.helper={},t.helper.isString=h,t.helper.isNumber=i,t.init=function(){v(function(){w()},function(a){console.log(a)})},a.tsw=t}(),c.init()}(window),function(a,b){"use strict";a.tsw=tsw||{},tsw.delay=function(a){var b=tsw.createNode(),c=tsw.wait(),d=tsw.gain(),e=tsw.gain(),f=tsw.gain();return b.settings={delayTime:.5,feedback:.5,level:.5},a=a||{},c.delayTime.value=a.delayTime||b.settings.delayTime,d.gain.value=a.feedback||b.settings.feedback,e.gain.value=a.level||b.settings.level,tsw.connect(b.input,f,c,d,c,e,b.output),tsw.connect(f,c),b},tsw.distortion=function(a){var b=tsw.createNode(),c=tsw.context().createWaveShaper(),d=tsw.context().createBiquadFilter(),e=tsw.context().createBiquadFilter();return b.settings={distortionLevel:.5},a=a||{},tsw.connect(b.input,c,[d,e],b.output),b},tsw.phaser=function(a){var b=tsw.createNode(),c=[],d=tsw.gain(),e=0;for(b.settings={rate:8,depth:.5,feedback:.8},a=a||{},d.gain.value=a.feedback||b.settings.feedback,a.rate=a.rate||b.settings.rate,e=0;e<a.rate;e++)c[e]=tsw.context().createBiquadFilter(),c[e].type=7,c[e].frequency.value=100*e;for(e=0;e<c.length-1;e++)tsw.connect(c[e],c[e+1]);return tsw.connect(b.input,c[c.length-1],d,c[0]),tsw.connect(c[c.length-1],b.output),b.setCutoff=function(a){for(var b=0;b<c.length;b++)c[b].frequency.value=a},b},tsw.reverb=function(a){var b=tsw.context().createConvolver(),c=tsw.gain(),d={},e={effectLevel:.5,reverbTime:.5,reverbType:"spring",reverbPath:""};return a=a||{},c.gain.value=a.effectLevel||e.effectLevel,tsw.load({hall:"/effects/reverb/responses/bright-hall.wav",room:"/effects/reverb/responses/medium-room.wav",spring:"/effects/reverb/responses/feedback-spring.wav"},function(a){e.reverbPath=a[e.reverbType],b.buffer=e.reverbPath,d.input=tsw.gain(),d.output=tsw.gain(),tsw.connect(d.input,[d.output,b]),tsw.connect(b,c),tsw.connect(c,d.output)}),d},tsw.tremolo=function(a){var b={},c=(tsw.gain(),this.lfo()),d=this;return a=a||{},b.input=tsw.gain(),b.connect=function(a){b.input.connect(a),c.modulate(b.input.gain),c.start(d.now())},b.setRate=function(a){c.frequency(a)},b.setDepth=function(a){c.depth(a)},b}}(window),function(a,b){"use strict";var c=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];c.push.apply(c,c);var d=["unison","flat 2nd","2nd","minor 3rd","major 3rd","perfect 4th","flat 5th","perfect 5th","minor 6th","major 6th","minor 7th","major 7th","octave","flat 9th","9th","sharp 9th","major 10th","11th","augmented 11th","perfect 12th","flat 13th","13th"];tsw.helper.getNotePosition=function(a){for(var b,d=c.length,e=0;d>e;e++)if(a.toUpperCase()===c[e])return b=e,e;return null};var e=function(a){var b=[],d=tsw.helper.getNotePosition(a);return b.push(c[d]),b.push(c[d+2]),b.push(c[d+4]),b.push(c[d+5]),b.push(c[d+7]),b.push(c[d+9]),b.push(c[d+11]),b.push(c[d+12]),b},f=function(a){var b=[],d=tsw.helper.getNotePosition(a);return b.push(c[d]),b.push(c[d+2]),b.push(c[d+3]),b.push(c[d+5]),b.push(c[d+7]),b.push(c[d+8]),b.push(c[d+10]),b.push(c[d+12]),b},g=function(a){return"string"!=typeof a||a.length>3?!1:!0};tsw.chord=function(a){var b={},d=[],e=0;return Array.isArray(a)?!1:(a=a.toLowerCase(),b.rootNote=a[0].toUpperCase(),b.isMajor=a.indexOf("maj")>-1,b.isMinor=!b.isMajor&&a.indexOf("m")>-1,b.is7th=a.indexOf("7")>-1,b.notes=[],b.is7th||(b.octave=a.match(/\d/g)),b.isMajor||b.isMinor||a.is7th||(b.isMajor=!0),e=tsw.helper.getNotePosition(b.rootNote),d.push(e),a.isMinor?d.push(e+tsw.semitoneDifference("minor 3rd")):d.push(e+tsw.semitoneDifference("major 3rd")),d.push(e+tsw.semitoneDifference("perfect 5th")),d.push(e+tsw.semitoneDifference("octave")),d.forEach(function(a){b.notes.push(c[a])}),b.notes)},tsw.scale=function(a,b){return"minor"===b?f(a):e(a)},tsw.semitoneDifference=function(a){for(var b=d.length,c=0;b>c;c++)if(a===d[c])return c},tsw.flat=function(a){var b;return a=a.replace("#","b"),b=String.fromCharCode(a[0].toUpperCase().charCodeAt(0)+1),"H"===b&&(b="A"),b+=a.substr(1)},tsw.sharp=function(a){var b,c=0;return-1===a.indexOf("b")?a:(a=a.replace("b","#"),b=String.fromCharCode(a[0].toUpperCase().charCodeAt(0)-1),"@"===b&&(b="G"),"B"===b&&(c=a.search(/\d/),c>-1&&(a=a.substring(0,c)+(a[c]-1)+a.substring(c+1))),b+=a.substr(1))},tsw.frequency=function(a){var b,d,e,f;return g(a)===!1?!1:(e=a.search(/\d/),b=parseInt(a.slice(-1)),isNaN(b)&&(b=4),a=this.sharp(a),f=a,e>-1&&(f=a.substr(0,e)),d=c.indexOf(f.toUpperCase()),d+=12*b,parseFloat(440*Math.pow(2,(d-57)/12),10))}}(window),function(a,b){"use strict";tsw=tsw||{},tsw.isMidiSupported=function(){return"function"==typeof navigator.requestMIDIAccess},tsw.getUserMidi=function(a,b){this.isMidiSupported()&&navigator.requestMIDIAccess().then(a,b)};var c=function(a){var b=a.match(/^[A-g#]+/)[0],c=parseInt(a.match(/\d+/g),10),d=tsw.helper.getNotePosition(b);return d+12*c},d=function(a){var b=a%12,c=Math.floor(a/12),d=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return d.push.apply(d,d),d[b]+c};tsw.midiNote=function(a){return tsw.helper.isString(a)?c(a):tsw.helper.isNumber(a)?d(a):void 0}}(window),function(a,b){"use strict";var c=function(a){var b=Math.floor(a/60);return{minutes:b,seconds:a-60*b,totalSeconds:a}};tsw.analyser=function(){var a=tsw.context().createAnalyser();return a},tsw.info=function(a){return{duration:c(a.duration),numberOfChannels:a.numberOfChannels,sampleRate:a.sampleRate}}}(window);